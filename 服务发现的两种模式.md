# **服务发现的两种模式**：轮询（拉取）和监听（推送）

---

## 1️ `list`（轮询方式）

* **机制**：客户端每隔一定时间向 Nacos 查询一次服务列表（拉取最新的服务实例信息）。
* **特点**：

  * 简单、实现容易。
  * 可能有延迟（取决于轮询间隔）。
  * 对 Nacos 服务端压力相对大，尤其服务实例数量多时。
* **适用场景**：

  * 服务数量少、更新不频繁。
  * 对实时性要求不高的系统。

---

## 2️ `watch`（推送/监听方式）

* **机制**：客户端注册一个监听器，一旦 Nacos 上服务实例发生变更，Nacos 会 **主动推送**变化给客户端。
* **特点**：

  * 实时性高，变化立刻感知。
  * 客户端无需频繁轮询，减少网络开销。
  * Spring Cloud Alibaba 的 `Nacos Discovery` 默认就是 **基于推送** 的。
* **适用场景**：

  * 服务频繁上下线。
  * 对负载均衡选择实时性要求高（避免调用已经下线的实例）。
  * 大规模微服务集群。

---

## 3️ Spring Cloud Alibaba 的使用

在 Spring Cloud Alibaba + Nacos 的微服务体系里：

```text
@ServiceA --> Nacos Discovery Client --> 获取 ServiceB 实例列表
```

* **底层实现**：

  * 默认是 **订阅（watch）模式**，Nacos 客户端会维护本地缓存。
  * 当服务实例变更时，本地缓存更新。
  * 调用方通过 **客户端负载均衡（LoadBalancer）** 选择实例，完全不需要手动轮询。

>  总结：
>
> * `list`：拉取，简单但延迟高。
> * `watch`：推送，实时性好，Nacos 在微服务场景中推荐使用。
> * Spring Cloud Alibaba 已经封装好，默认使用 `watch`，开发者几乎不用关心。


