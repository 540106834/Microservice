判断 **是否需要加异常处理**，核心就是看 **你的代码会不会抛出异常，以及异常类型是什么**。我们可以用一个简单的步骤来判断：


### 1. 先看异常类型

Java 异常分两大类：

| 类型                              | 特征                | 编译器要求                          |
| ------------------------------- | ----------------- | ------------------------------ |
| **受检异常 (Checked Exception)**    | 必须捕获或声明抛出         | **必须加** `try/catch` 或 `throws` |
| **非受检异常 (Unchecked Exception)** | 运行时可能出现，一般是程序逻辑错误 | **可加可不加**，编译器不强制               |

**例子：**

* 受检异常：`IOException`, `SQLException`, `ClassNotFoundException` → **必须处理**
* 非受检异常：`NullPointerException`, `ArithmeticException`, `ArrayIndexOutOfBoundsException` → **可处理，可不处理**

---

### 2. 看你希望程序如何表现

* **容忍错误，继续执行** → 必须加异常处理。
* **出错立即终止，抛给调用者或用户处理** → 可以用 `throws` 或不处理非受检异常。

---

### 3. 判断流程（通俗版）

可以把它想成 **三问法**：

1. **这行代码可能出错吗？**

   * 文件不存在、网络断开、数据库操作 → 可能出错
   * 数组访问越界、除零、空指针 → 可能出错
   * 单纯算术、变量赋值 → 通常安全

2. **这个错误是受检异常吗？**

   * 是 → **必须处理**
   * 否 → 下一步考虑

3. **我希望程序遇到错误继续运行吗？**

   * 是 → **加 try/catch**
   * 否 → 可以不处理，让程序崩溃或用 `throws` 抛给调用者

---

### 4. 通俗总结

* **受检异常 → 必须加**
* **非受检异常 → 根据需求加**
* **加异常处理的价值 → 程序稳健、用户体验好、容易调试**


 # **Java 异常处理**，包括 `try/catch/finally/throws` 的用法和原理

## 1 异常的概念

**异常（Exception）**：程序运行过程中出现的不正常情况，打断正常流程。

Java 异常分两类：

| 类型                   | 描述             | 例子                                                       |
| -------------------- | -------------- | -------------------------------------------------------- |
| **检查型异常（Checked）**   | 编译时必须处理，否则编译报错 | `IOException`, `SQLException`                            |
| **运行时异常（Unchecked）** | 运行时才可能出现，可选择处理 | `NullPointerException`, `ArrayIndexOutOfBoundsException` |
| **错误（Error）**        | JVM 层面错误，一般不处理 | `OutOfMemoryError`, `StackOverflowError`                 |

---

## 2 `try-catch` 捕获异常

**作用**：捕获异常，防止程序崩溃，允许你处理异常。

**语法**：

```java
try {
    // 可能产生异常的代码
    int result = 10 / 0;
} catch (ArithmeticException e) {
    // 异常处理逻辑
    System.out.println("除数不能为0: " + e.getMessage());
} catch (Exception e) {
    // 捕获其他异常
    e.printStackTrace();
} finally {
    // 无论是否发生异常都会执行
    System.out.println("finally 块执行");
}
```

✅ 特点：

* 可以有多个 `catch`，从子类异常到父类异常
* `finally` 可选，用于释放资源，如关闭文件、数据库连接
* `catch` 捕获异常后，程序可以继续执行

---

## 3 `throws` 声明异常

**作用**：将异常抛给调用者处理，自己不处理。

**语法**：

```java
public void readFile(String path) throws IOException {
    FileReader file = new FileReader(path);
    file.read();
    file.close();
}
```

调用者必须处理或继续抛出：

```java
public static void main(String[] args) {
    try {
        readFile("test.txt");
    } catch (IOException e) {
        System.out.println("文件读取失败: " + e.getMessage());
    }
}
```

✅ 特点：

* 只能用于 **检查型异常**（Checked Exception）
* 提高方法复用性，调用者可以自定义处理策略

---

## 4 异常处理注意点

1. **不要滥用 catch(Exception e)**

   * 会掩盖真实异常，排查问题困难
   * 最好针对具体异常类型捕获

2. **资源释放推荐 try-with-resources（Java 7+）**

   ```java
   try (FileReader fr = new FileReader("test.txt")) {
       // 自动关闭 fr
   } catch (IOException e) {
       e.printStackTrace();
   }
   ```

3. **运行时异常（Unchecked Exception）一般不强制捕获**

   * 例如 `NullPointerException`，只在需要保护时捕获

4. **自定义异常**

   * 继承 `Exception` 或 `RuntimeException`
   * 方便业务层抛出特定错误

```java
public class MyException extends Exception {
    public MyException(String message) {
        super(message);
    }
}

public void doSomething() throws MyException {
    throw new MyException("自定义异常");
}
```

---

## 5 总结

| 关键字       | 功能          |
| --------- | ----------- |
| `try`     | 包裹可能抛出异常的代码 |
| `catch`   | 捕获异常并处理     |
| `finally` | 必定执行（清理资源）  |
| `throws`  | 声明异常，由调用者处理 |

 核心思想：

1. **异常发生 → try/catch 捕获 → 处理或记录 → finally 释放资源**
2. **异常传递 → throws 声明 → 由上层调用者决定如何处理**

---

如果你愿意，我可以帮你画一张 **异常处理流程图**，从方法调用到异常抛出、捕获、finally 执行，全流程可视化，非常直观。

你希望我画吗？
