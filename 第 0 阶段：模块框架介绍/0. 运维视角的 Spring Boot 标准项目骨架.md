# **â€œè¿ç»´è§†è§’çš„ Spring Boot æ ‡å‡†é¡¹ç›®éª¨æ¶â€**ã€‚
Spring Boot = æŠŠâ€œè¯·æ±‚è¿›æ¥ â†’ è·‘ä¸€æ®µæµç¨‹ â†’ ç”¨ç‚¹èµ„æº â†’ å®‰å…¨è¿”å›â€è¿™ä»¶äº‹ï¼Œæ ‡å‡†åŒ–

ç›®æ ‡åªæœ‰ä¸€ä¸ªï¼š**ä¸Šçº¿ç¨³ã€å¥½æ’éšœã€ä¸å‘äºº**ã€‚

è¿™ä¸æ˜¯æ•™å­¦ Demoï¼Œè€Œæ˜¯é‚£ç§

> åŠå¤œæŠ¥è­¦ä½ ä¹Ÿèƒ½è¿…é€Ÿæ‘¸æ¸…ç»“æ„çš„é¡¹ç›®ã€‚

---

## ä¸€ã€æ•´ä½“è®¾è®¡åŸåˆ™ï¼ˆå…ˆå®šè°ƒï¼‰

ä»è¿ç»´è§’åº¦ï¼Œé¡¹ç›®ç»“æ„è¦æ»¡è¶³å››ä¸ªè¯ï¼š

* **å¯è¯»**
* **å¯æ§**
* **å¯è§‚æµ‹**
* **å¯æ‰©å±•**

æ‰€ä»¥æˆ‘ä»¬é¿å…ï¼š

* èŠ±å“¨åˆ†å±‚
* è¿‡æ—©æ‹†å¾®æœåŠ¡
* Controller å†™ä¸šåŠ¡

---

## äºŒã€æ¨èé¡¹ç›®éª¨æ¶ï¼ˆå•ä½“ / æ¥å£å‹ï¼‰

```text
ops-springboot-demo
â”œâ”€â”€ pom.xml
â””â”€â”€ src
    â””â”€â”€ main
        â”œâ”€â”€ java
        â”‚   â””â”€â”€ com.example.opsdemo
        â”‚       â”œâ”€â”€ OpsDemoApplication.java   # å¯åŠ¨ç±»
        â”‚       â”‚
        â”‚       â”œâ”€â”€ controller                # æ¥å£å…¥å£
        â”‚       â”‚   â”œâ”€â”€ HealthController.java
        â”‚       â”‚   â””â”€â”€ UserController.java
        â”‚       â”‚
        â”‚       â”œâ”€â”€ service                   # ä¸šåŠ¡é€»è¾‘
        â”‚       â”‚   â”œâ”€â”€ UserService.java
        â”‚       â”‚   â””â”€â”€ impl
        â”‚       â”‚       â””â”€â”€ UserServiceImpl.java
        â”‚       â”‚
        â”‚       â”œâ”€â”€ repository                # æ•°æ®è®¿é—®
        â”‚       â”‚   â””â”€â”€ UserRepository.java
        â”‚       â”‚
        â”‚       â”œâ”€â”€ model
        â”‚       â”‚   â”œâ”€â”€ dto                   # æ¥å£å…¥å‚
        â”‚       â”‚   â”‚   â””â”€â”€ UserDTO.java
        â”‚       â”‚   â”œâ”€â”€ entity                # æ•°æ®åº“å®ä½“
        â”‚       â”‚   â”‚   â””â”€â”€ User.java
        â”‚       â”‚   â””â”€â”€ vo                    # æ¥å£å‡ºå‚
        â”‚       â”‚       â””â”€â”€ UserVO.java
        â”‚       â”‚
        â”‚       â”œâ”€â”€ config                    # é…ç½®ç±»
        â”‚       â”‚   â”œâ”€â”€ WebConfig.java
        â”‚       â”‚   â””â”€â”€ ThreadPoolConfig.java
        â”‚       â”‚
        â”‚       â”œâ”€â”€ filter                    # Filter
        â”‚       â”‚   â””â”€â”€ TraceIdFilter.java
        â”‚       â”‚
        â”‚       â”œâ”€â”€ interceptor               # æ‹¦æˆªå™¨
        â”‚       â”‚   â””â”€â”€ AuthInterceptor.java
        â”‚       â”‚
        â”‚       â”œâ”€â”€ aspect                    # AOP
        â”‚       â”‚   â””â”€â”€ LogAspect.java
        â”‚       â”‚
        â”‚       â”œâ”€â”€ common                    # é€šç”¨ç»„ä»¶
        â”‚       â”‚   â”œâ”€â”€ Result.java
        â”‚       â”‚   â”œâ”€â”€ ErrorCode.java
        â”‚       â”‚   â””â”€â”€ BizException.java
        â”‚       â”‚
        â”‚       â””â”€â”€ util                      # å·¥å…·ç±»
        â”‚           â””â”€â”€ TimeUtil.java
        â”‚
        â””â”€â”€ resources
            â”œâ”€â”€ application.yml               # ä¸»é…ç½®
            â”œâ”€â”€ application-dev.yml           # å¼€å‘ç¯å¢ƒ
            â”œâ”€â”€ application-prod.yml          # ç”Ÿäº§ç¯å¢ƒ
            â””â”€â”€ logback-spring.xml            # æ—¥å¿—
```

è¿™å¥—ç»“æ„ï¼Œä½ å¯ä»¥ **åŸå°ä¸åŠ¨å¤åˆ¶**ï¼Œä¸æ€•è¿‡æ—¶ã€‚

---

## ä¸‰ã€æ¯ä¸€å±‚â€œè¿ç»´ä¸ºä»€ä¹ˆè¦è¿™æ ·æ”¾â€

### 1ï¸âƒ£ controller å±‚

 **äº‹æ•…å…¥å£**

* æ‰€æœ‰æ¥å£ä¸€çœ¼å¯è§
* health / metrics / admin éƒ½åœ¨è¿™

```text
/health
/actuator
/users/**
```

---

### 2ï¸âƒ£ service / impl åˆ†ç¦»

 **ä¸ºæ‰©å±•ç•™åè·¯**

* æ¥å£ + å®ç°
* æ–¹ä¾¿ Mock
* æ–¹ä¾¿å°†æ¥æ‹† RPC

---

### 3ï¸âƒ£ common åŒ…ï¼ˆéå¸¸å…³é”®ï¼‰

 **ç»Ÿä¸€ä¸–ç•Œè§‚**

```java
Result<T>
BizException
ErrorCode
```

 è¿ç»´æ„ä¹‰

> æ—¥å¿—ã€æŠ¥è­¦ã€è¿”å›ç ï¼Œå…¨éƒ½ç»Ÿä¸€å£å¾„ã€‚

---

### 4ï¸âƒ£ filter / interceptor / aspect åˆ†å¼€

 **æ’éšœç¥å™¨**

| å±‚çº§          | ä½œç”¨         |
| ----------- | ---------- |
| Filter      | TraceIdã€ç¼–ç  |
| Interceptor | é‰´æƒ         |
| AOP         | æ—¥å¿—ã€è€—æ—¶      |

ğŸ‘‰ å‡ºé—®é¢˜æ—¶ä½ èƒ½**å¿«é€Ÿå®šä½æ˜¯å“ªä¸€å±‚æˆªæ–­äº†è¯·æ±‚**ã€‚

---

### 5ï¸âƒ£ config åŒ…

 **â€œæ‰€æœ‰é­”æ³•é›†ä¸­è¥â€**

* WebMvc é…ç½®
* çº¿ç¨‹æ± 
* JSON åºåˆ—åŒ–
* è·¨åŸŸ

 è¿ç»´æœ€æ€•é…ç½®æ•£è½ï¼Œè¿™æ ·æ”¶å£æœ€å¥½ã€‚

---

### 6ï¸âƒ£ resources é…ç½®æ‹†ç¯å¢ƒ

```yaml
spring:
  profiles:
    active: dev
```

* dev / test / prod
* é…åˆå¯åŠ¨å‚æ•°åˆ‡æ¢

```bash
java -jar app.jar --spring.profiles.active=prod
```

---

## å››ã€ä¸Šçº¿å¿…å¤‡çš„ 3 ä¸ªæ¥å£ï¼ˆè¿ç»´çº¢çº¿ï¼‰

### âœ… å¥åº·æ£€æŸ¥

```java
@GetMapping("/health")
public String health() {
    return "UP";
}
```

---

### âœ… åŸºæœ¬ä¿¡æ¯

```java
@GetMapping("/info")
public Map<String, Object> info() {
    return Map.of(
        "app", "ops-demo",
        "version", "1.0.0"
    );
}
```

---

### âœ… æ—¥å¿— TraceId

```text
traceId=8f3a9c...
```

> ä¸€æ¡è¯·æ±‚ï¼Œä»è¿›åˆ°å‡ºèƒ½ä¸²æˆä¸€æ¡çº¿ã€‚

---

## äº”ã€ä½ ç°åœ¨çš„èƒ½åŠ›åæ ‡

å¦‚æœä½ èƒ½ï¼š

* çœ‹ç»“æ„å°±çŸ¥é“æœåŠ¡å¹²å˜›
* çŸ¥é“æ—¥å¿—è¯¥æ‰“åœ¨å“ªä¸€å±‚
* èƒ½å¿«é€Ÿåˆ¤æ–­â€œé—®é¢˜åœ¨å“ªä¸€å±‚â€

ä½ å·²ç»ç«™åœ¨ **â€œè¿ç»´å‹åç«¯â€** çš„å°é˜¶ä¸Šäº†ã€‚

---

## å…­ã€ä¸‹ä¸€æ­¥æˆ‘å¼ºçƒˆå»ºè®®ä½ ç»§ç»­è¿™æ¡çº¿

ä½ å¯ä»¥é€‰ä¸€ä¸ªï¼Œæˆ‘ç›´æ¥ç»™ä½  **å¯è·‘ä»£ç çº§åˆ«** çš„å†…å®¹ï¼š

1ï¸âƒ£ **æœ€å°å¯è¿è¡Œè¿ç»´éª¨æ¶ Demoï¼ˆå«æ—¥å¿— + healthï¼‰**
2ï¸âƒ£ **ä¸€æ¬¡æ…¢æ¥å£çš„å®Œæ•´æ’éšœæ¼”ç»ƒï¼ˆçœŸå®æµç¨‹ï¼‰**
3ï¸âƒ£ **Filter / Interceptor / AOP ä¸‰ä»¶å¥—å¯¹æ¯” + é€‰æ‹©æ ‡å‡†**

é€‰å“ªä¸ªï¼Ÿæˆ‘ç»§ç»­ç»™ä½ æŠŠè¿™å¥—éª¨æ¶â€œç‚¹äº®â€ã€‚
